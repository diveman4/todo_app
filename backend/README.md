# Todo App Backend API

## API概要
TodoアプリケーションのバックエンドAPIサーバーです。フロントエンドから送られてくるリクエストを受け取り、データベースに保存されているTodoアイテムの作成・取得・更新・削除を行うREST API

主な機能：
- Todoアイテムの一覧取得
- 新しいTodoアイテムの作成
- 既存のTodoアイテムの更新（完了状態の変更、内容の編集など）
- Todoアイテムの削除

## 使用技術・ライブラリ一覧とその選定理由

### コア技術

#### **Hono** (v4.11.4)
- **選定理由**: APIサーバとして使用。軽量で高速なWebフレームワークであること。また、TypeScriptとの相性が良く、型安全性を保ちながら開発できる為選定。

#### **Prisma** (v6.19.2)
- **選定理由**: 型安全なORMツールであること。データベースのスキーマを定義すると、自動的にTypeScriptの型が生成され、コンパイル時にエラーを検出できる為選定。

#### **TypeScript** (v5.8.3)
- **選定理由**: フロントエンドがTypeScript推奨であったため、技術スタックを統一するためバックエンドもTypeScriptを選択。また、コードの可読性と保守性が良いため選定。

#### **PostgreSQL**
- **選定理由**: 多くの企業で採用されているデータベースである為。普段業務で使っていないため、せっかくの機会に選定。

### 開発ツール

#### **tsx** (v4.7.1)
- **選定理由**: 開発中にいちいちコンパイルする必要がなく、ホットリロードに対応している為選定。

#### **@hono/node-server** (v1.19.9)
- **選定理由**: HonoアプリケーションをNode.jsサーバーとして動作させることができる。honoと同梱のため。

## 環境構築手順

### 前提条件
- Docker と Docker Compose がインストールされていること

### Docker Composeを使った起動

1. **プロジェクトのルートディレクトリに移動**
   cd todo_app

2. **Docker Composeでサービスを起動**
   docker-compose up -d

   このコマンドで、データベースとフロントエンドとバックエンドAPIサーバーが自動的に起動

   backendサーバーは http://localhost:3001 で起動する（docker-compose.yml参照）

3. **データベースのマイグレーション実行**
   docker-compose exec backend npx prisma migrate deploy

   または、初回セットアップの場合：
   docker-compose exec backend npx prisma migrate dev


## APIエンドポイント

すべてのエンドポイントは `http://localhost:3001` をベースURLとします。

### 1. Todo一覧取得

**GET** `/todos`

- **説明**: 保存されているすべてのTodoアイテムを取得します。作成日時の新しい順に並びます。
- **リクエスト**: なし
- **レスポンス例**:
  ```json
  [
    {
      "id": 1,
      "title": "買い物に行く",
      "description": "牛乳とパンを買う",
      "completed": false,
      "dueDate": "2024-01-20T00:00:00.000Z",
      "priority": "MEDIUM",
      "createdAt": "2024-01-15T10:00:00.000Z",
      "updatedAt": "2024-01-15T10:00:00.000Z"
    }
  ]
  ```

### 2. Todo作成

**POST** `/todos`

- **説明**: 新しいTodoアイテムを作成します。
- **リクエストボディ**:
  ```json
  {
    "title": "買い物に行く",          
    "description": "牛乳とパンを買う",  
    "dueDate": "2024-01-20",          
    "priority": "HIGH"                // 任意（HIGH, MEDIUM, LOW）
  }
  ```
- **レスポンス**: 作成されたTodoアイテム（ステータスコード: 201）
- **エラー**: `title`が未指定の場合、400エラーを返します

### 3. Todo更新

**PUT** `/todos/:id`

- **説明**: 指定されたIDのTodoアイテムを更新します。部分更新に対応しており、指定したフィールドのみ更新されます。
- **パスパラメータ**: `id` (TodoアイテムのID)
- **リクエストボディ例**:
  ```json
  {
    "completed": true,
    "title": "買い物に行く（更新）"
  }
  ```
- **レスポンス**: 更新されたTodoアイテム
- **エラー**: 指定されたIDが存在しない場合、404エラーを返します

### 4. Todo削除

**DELETE** `/todos/:id`

- **説明**: 指定されたIDのTodoアイテムを削除します。
- **パスパラメータ**: `id` (TodoアイテムのID)
- **レスポンス**:
  ```json
  {
    "message": "Deleted successfully"
  }
  ```
- **エラー**: 指定されたIDが存在しない場合、404エラーを返します

## 工夫した点・アピールポイント

### 1. **型安全性の徹底**
- PrismaとTypeScriptを組み合わせることで、データベースのスキーマとコードの型が常に一致。これにより、コンパイル時にエラーを発見でき、実行時のエラーを大幅に逓減。

### 2. **エラーハンドリング**
- すべてのエンドポイントでtry-catch文を使用し、エラーが発生した場合に適切なHTTPステータスコード（400, 404, 500など）とエラーメッセージを返すよう設定。これにより、フロントエンド側でエラーを処理可能。

### 3. **CORS設定**
- フロントエンドとバックエンドが異なるポートで動作することを考慮し、CORS（Cross-Origin Resource Sharing）を有効化しています。これにより、ブラウザのセキュリティ制限を回避。

### 4. **デフォルト値の設定**
- 新規作成時に`priority`が指定されていない場合は、自動的に`MEDIUM`が設定されるなど、ユーザビリティを考慮したデフォルト値の設定。

### 5. **Docker環境の整備**
- Docker Composeを使用することで、データベースとAPIサーバーを簡単に起動でき、開発環境の構築が容易。

### 6. **経験の少ない言語、フレームワークの選択**
- 通常業務において言語はPython、DBではMySQLなどを使用していた。知見蓄積のため、今回は敢えてそれらを使わずに構築。